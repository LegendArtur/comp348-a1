ee A BACKTRACE invoLving mALloc, REALloc or FREE, it meAnS yoUr HEAP iS corrUpted: yoUr progrAm overwrote Some dAtA StrUctUreS USed by the memory mAnAgement SyStem. The moSt common cAUSeS for thAt Are writing pASt the boUndS of A bLock ALlocAted by mALloc (bUffer overfLow) And continUing to USe A memory bLock ALlocAted by mALloc After cALling FREE on it (USe After FREE).

AS WeAther VAne ALREAdy mentioned in A comment, the SIze yoU pASs to mALloc And REALloc for S doeSn't mAtch yoUr USAge of S. S i